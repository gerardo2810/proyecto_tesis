system-view
sysname PE-3
#
ip vpn-instance CUSTOMER_3
ipv4-family
route-distinguisher 300:1
vpn-target 111:1 both
#
interface GigabitEthernet3/0/2
 ip binding vpn-instance CUSTOMER_3
 description PE-3 <-> CE-3
 ip address 192.168.3.1 255.255.255.252
 undo shutdown
#
interface GigabitEthernet3/0/5
 description PE-3 <-> P-4
 ip address 172.27.1.1 255.255.255.252
 undo shutdown
#
interface GigabitEthernet3/0/6
 description PE-3 <-> P-3
 ip address 172.7.1.1 255.255.255.252
 undo shutdown
#
interface lo0
ip add 3.3.3.10 32
#
isis 1
is-leve level-1 
network-entity 49.0002.0000.0001.00
inter g3/0/5
isis ena 1
isis circuit-level level-1
inter g3/0/6
isis ena 1
isis circuit-level level-1

inter lo0
isis e 1
#
mpls lsr-id 3.3.3.10
mpls
mpls te
q
segment-routing
q
isis 1
cost-style wide
traffic-eng level-1
segment-routing mpls
segment-routing global-block 16000 20000
q
interface lo0
isis prefix-sid absolute 16300
q
explicit-path pe1-1
next sid label 17300 type prefix
next sid label 17100 type prefix
next sid label 16100 type prefix
q

explicit-path pe1-2
next sid label 17300 type prefix
next sid label 17200 type prefix
next sid label 16100 type prefix
q
explicit-path pe2-1
next sid label 17300 type prefix
next sid label 17200 type prefix
next sid label 16200 type prefix
q

explicit-path pe2-2
next sid label 17300 type prefix
next sid label 17100 type prefix
next sid label 16200 type prefix
q

explicit-path pe1-3
next sid label 17400 type prefix
next sid label 17100 type prefix
next sid label 16100 type prefix
q

explicit-path pe1-4
next sid label 17400 type prefix
next sid label 17200 type prefix
next sid label 16100 type prefix
q
explicit-path pe2-3
next sid label 17400 type prefix
next sid label 17100 type prefix
next sid label 16200 type prefix
q

explicit-path pe2-4
next sid label 17400 type prefix
next sid label 17200 type prefix
next sid label 16200 type prefix
q

interface tunnel1
ip address unnumbered interface lo0
tunnel-protocol mpls te
destination 1.1.1.10
mpls te tunnel-id 1
mpls te signal-protocol segment-routing
mpls te path explicit-path pe1-1
commit
comm

interface tunnel2
ip address unnumbered interface lo0
tunnel-protocol mpls te
destination 1.1.1.10
mpls te tunnel-id 2
mpls te signal-protocol segment-routing
mpls te path explicit-path pe1-2
commit
comm

interface tunnel3
ip address unnumbered interface lo0
tunnel-protocol mpls te
destination 1.1.1.10
mpls te tunnel-id 3
mpls te signal-protocol segment-routing
mpls te path explicit-path pe1-3
commit
comm

interface tunnel4
ip address unnumbered interface lo0
tunnel-protocol mpls te
destination 1.1.1.10
mpls te tunnel-id 4
mpls te signal-protocol segment-routing
mpls te path explicit-path pe1-4
commit
comm

interface tunnel5
ip address unnumbered interface lo0
tunnel-protocol mpls te
destination 2.2.2.10
mpls te tunnel-id 5
mpls te signal-protocol segment-routing
mpls te path explicit-path pe2-1
commit
comm

interface tunnel6
ip address unnumbered interface lo0
tunnel-protocol mpls te
destination 2.2.2.10
mpls te tunnel-id 6
mpls te signal-protocol segment-routing
mpls te path explicit-path pe2-2
commit
comm

interface tunnel7
ip address unnumbered interface lo0
tunnel-protocol mpls te
destination 2.2.2.10
mpls te tunnel-id 7
mpls te signal-protocol segment-routing
mpls te path explicit-path pe2-3
commit
comm

interface tunnel8
ip address unnumbered interface lo0
tunnel-protocol mpls te
destination 2.2.2.10
mpls te tunnel-id 8
mpls te signal-protocol segment-routing
mpls te path explicit-path pe2-4
commit
#
bgp 100
peer 2.2.2.10 as-number 100
peer 2.2.2.10 connect-interf lo0
peer 4.4.4.10 as-number 100
peer 4.4.4.10 connect-interf lo0
peer 1.1.1.10 as-number 100
peer 1.1.1.10 connect-interf lo0
ipv4-family vpnv4
peer 2.2.2.10 enable
y
peer 4.4.4.10 enable
y
peer 1.1.1.10 enable
y
ipv4-family vpn-instance CUSTOMER_3
peer 192.168.3.2 as-number 65420
